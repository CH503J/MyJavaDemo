# **一、WordUtils模块**

**Aspose Words For Java 依赖库的使用**

## **1.五书拆分（待处理）**

1. 根据docx文件的页眉进行拆分（已完成）
    1.[ ] 资源管理：
        + Aspose words资源释放
        + 临时文件锁竞争
    2.[ ] 大型文件拆分（考虑资源管理即可，目前没有大文件需要处理）
    3.[ ] 安全防护：文档中代码注入问题
    4.[ ] 复杂元素：
        + 表格、图片、Visio图等，拆分是根据页眉分节进行的，如果分节是文档中最大页单位则不需考虑
    5.[ ] 异常处理
    6.[ ] 适配问题
        + 多平台
        + 字符编码utf8
    7.[ ] 线程并发
        + 多用户同时调用工具类，通过时间戳在临时文件夹中生成唯一文件夹，用于存放文件
    8.[ ] 文件管理
2. 将拆分出的新docx格式文件转换为PDF格式文件（已完成）
    1. 说明书附图的pdf格式文件图片只能要求撰写者按照每页一张图来撰写稿件
    2. 权利要求数统计和权利要求项具体内容
        1. 统计（已完成）
        2. 具体内容（可以获取带编号的段落）
3. 将拆分出的新docx格式文件转换为XML格式文件（待完成）
    1. 权利要求书的规则
    2. 说明书的规则
    3. 说明书附图的规则
        1. 特别是附图在导入国知局后无法识别到每页只存在一张图片（缩放比例问题）
    4. 摘要和摘要附图

## **2.委托书加电子章（待完成）**

1. 检测委托书图片像素（待完成）
2. 缩放委托书图片（待完成）
3. 检测委托书中印章位置（待完成）
4. 印章底边距离委托书图片底部距离（待完成）
5. 加载电子章图片（png格式）（待完成）
6. 找到电子章具体位置进行裁剪（待完成）
7. 获取裁剪后电子章的像素（宽高）（待完成）
8. 用电子章的宽高与印章底边距离委托书底部距离进行对比（待完成）
9. 如果电子章宽高大于印章底边距离委托书底部距离，则抛出异常（待完成）
10. 将电子章添加到印章下方随机位置（待完成）
    1. 缩放（待完成）
    2. 变换角度
    3. 随机偏移量

### 2.1委托书中的签名如何检测？

### 2.2签名与电子章之间的比率如何计算？

### 2.3如果是椭圆形章、长方形章或者方形章应该怎么办？

1. [ ] 根据页眉进行拆分（已完成）